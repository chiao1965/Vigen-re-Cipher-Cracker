# Vigenère Cipher Cracker

Description
---
This problem is related to Vigenère Cipher.

To encipher a message, it will choose a word of phrase as the keyword for the message first. Then repeatedly write this keyword over the plaintext message until the keystream is equal in length to the plaintext.

Following steps are what we do for breaking the Vigenère Cipher.
1. Split encrypted messages into different nums of groups and calculate index of coincidence (I.C.) to determine the keyword length.
2. Determine which key value (means shift letters left by 0-26) will result in the minimum chi-squared score for each group.
3. Finally, break this ciphertext and recover the plaintext.


Runnung Environments
---
Suggested running environments: Linux Ubuntu 16.04.12, Python 3.9.12

You can execute 311706007.py by this command:
```
python 311706007.py -o output_filename.txt
```
Next, you will receive the prompt
```
Please enter the encrypted message:
```
This program will need to read the message from stdin, therefore please enter the encrypted message in this step, then press enter after finishing. For example:
```
ZQQTK PQUWD PGMWD BQTXY LFQWL SHAJB UCIPV KUQEJ RBAAC LRSIZ ZCRWT LDFMT PGYXF ISOSE ASZXN PHTAY HHIIR ADDIJ LBFOE VKUWW VFFLV TCEXG HFFXF ZVGXF BFQEI ZOSEZ UGFGF UJUGK PCZWZ UQQJI VAFLV CSDCX YOPYR SQTEI HQFII VTAYI LRGGR AWARN LAGWK JCZXZ UIMPC FTAVX LHMRU LAMRT PDMXV VIDWV SJQWW YCYOE VKXIU NSBVV CWAYJ SMMGH BWDIU DSYYJ AGQXR ZWPIF SRZSK PCZWR URQQS YOOIW YSELF USEEE KOEAV SSMVE DSYYJ APQHR PZKYE SSMVE PBSWF TSFLZ UUILZ JVUXY HGOSJ AIERF ZAMPC SONSL YOZHR ULUIK FHAET XIUVV HBPXY PGPMW MWOYC AMMXK HQTIJ PHEIC MAAVV JZAWV SMFSR UOSIZ UKTMT ODDSX YSEWY HGSEZ USPEJ AFARX HGOIE KSZGP VJQVG YSVYU PQQEE KWZAY PQTTV YGARJ HBPXY PBSWR YSPEP IMPEP MWZHZ UUFLV PFDIR SZQZV SWZPZ LIAJK OSUVT VBHIE AWARR SJMPL LHTIJ HAQTI PBOMG SSEAY PQTLR CSEAV WHMAR FHDEU PHUSE HZMFL ZSEEE KKTMT OODID HYURX YOBMU OOHST HAARX AVQVV CSZYV ZCRWZ USOYI PGFWR UREXI PDBME NHTIK OWZXR DRDCM LWXJI VAMXK YOOXZ CSEYG LFEXZ AWARJ HFQAF YYURX HGMGK PJQPP PBXMK LFMXL YSMWZ UGAGZ LHKXY LQDIU BZUXP VTARV DFUXV YCDXY LDMVK POXMK FCREE VHTII MWZHJ HGBSN LFRYC HHAYT OGFSE LOZHR ZKTSC LGAQV HQTEJ AWEID LBFME AVQLV HZFLP ZQQTK PQUWD VTMXV TDQVR ASOPR ZGAJR UHMKF UWEXJ HGFLV KFQED ZCRGF UGQVM HHUWD VFFLV PABSJ AIDIJ VTBPL YOXMJ AGURV JIDIJ PBFLV JVGVT OVUWK VFKEE KHDEU PHUSE DVQXY LFAJR UQUIE ACDGF TDMVR AWHIC FFQGV UHFMD LGMVV ZINNV JHQHK VJQVP KWRJV YSZXY HBPPZ UURVF THTEK DVUGY AVQME KIXKV UQQSI JFQHL SWFCF MTAVD LFMKV ZQAYC KOXPF DAQVV ZHMXV TSZXJ HFQNV HZAYJ SMIEK JVQHR URFLV TCFMM LGAJK OSIVZ ASDJF YAMWZ TDAVK HBFEE PBSVV KWQRK PBFLV HBMPP ZWESW OWELZ ZHAVP HGFLV MOOXJ OSDIT VFPWG YCNES PZUXP PGMTF DSDJL SOZHK YCGFC LGAQV ASEXR URUXZ ZPKXY PGFVF BPXIJ VAQWK HBPEI KHTEK HZMVX LDAVK PCZSW OWEXF YWOEC LJUHV UQQMJ ZWRXV KQARJ PGFIE JMUWE VZQWJ WSDXZ UOOMF BGMRU LLMGK PBSME PHEHV TOZHJ PBNVZ LTFSN YWFIR OWEXF YMIID BGFOE VKYSI LHTEE TSDIW HQFWY BAMRE HHGVV CWQAV KIZHV YOZME KIOXZ VBAJV EHQRU LRQBG LFUIE JSUWK OSNIJ AVQPG ACFLV JFUXZ JWEQF MVGQR UVUWK VFKLZ ZHAVZ JOXGY HFMGK LFEGR UCZPP ISQWK PAMXV KPKXY LGFEE KODHN OWOLY BAMRV EDQVZ LBOIN OSFLV YOOXL HZAVK YOPMK PCZEI FVMWW BFZMJ OSPXF MCDQT VFDIT AJUIN ZCRME KWHMU BOXWN LAGWK YSSEI KHTID HGRSI TWZKG HFFWF MOSVV HHILF SSIID BGFQV HGGVV AVQQS FHTIZ YFQPR AWARK VHTID HGESW ISURX ZPKAY VAFLV FODIJ BFDSL URQHR URURT VBFID WZMXZ UUFLV PBOMU LBFWZ UHTIZ YZUZV ZCDGF URUXZ VBILZ JVFVR KWFMF UVMWY HBPIU KCIRK VIEAV TIEXI HHTII JCZWZ KSDXY LUQRV YOXFV HFURX VTFLV DVAPV UODVR AWHIK OOZXY LFQWG LQFMM LDDSS HPUPZ AMAJZ AGPIK HWXW
```
The information of decrypted message we will print included key length, keyword and plaintext.
```
Key length = 5
Keyword: HOMER
Plaintext: SCEPTICISMISASMUCHTHERESULTOFKNOWLEDGEASKNOWLEDGEISOFSCEPTICISMTOBECONTENTWITHWHATWEATPRESENTKNOWISFORTHEMOSTPARTTOSHUTOUREARSAGAINSTCONVICTIONSINCEFROMTHEVERYGRADUALCHARACTEROFOUREDUCATIONWEMUSTCONTINUALLYFORGETANDEMANCIPATEOURSELVESFROMKNOWLEDGEPREVIOUSLYACQUIREDWEMUSTSETASIDEOLDNOTIONSANDEMBRACEFRESHONESANDASWELEARNWEMUSTBEDAILYUNLEARNINGSOMETHINGWHICHITHASCOSTUSNOSMALLLABOURANDANXIETYTOACQUIREANDTHISDIFFICULTYATTACHESITSELFMORECLOSELYTOANAGEINWHICHPROGRESSHASGAINEDASTRONGASCENDENCYOVERPREJUDICEANDINWHICHPERSONSANDTHINGSAREDAYBYDAYFINDINGTHEIRREALLEVELINLIEUOFTHEIRCONVENTIONALVALUETHESAMEPRINCIPLESWHICHHAVESWEPTAWAYTRADITIONALABUSESANDWHICHAREMAKINGRAPIDHAVOCAMONGTHEREVENUESOFSINECURISTSANDSTRIPPINGTHETHINTAWDRYVEILFROMATTRACTIVESUPERSTITIONSAREWORKINGASACTIVELYINLITERATUREASINSOCIETYTHECREDULITYOFONEWRITERORTHEPARTIALITYOFANOTHERFINDSASPOWERFULATOUCHSTONEANDASWHOLESOMEACHASTISEMENTINTHEHEALTHYSCEPTICISMOFATEMPERATECLASSOFANTAGONISTSASTHEDREAMSOFCONSERVATISMORTHEIMPOSTURESOFPLURALISTSINECURESINTHECHURCHHISTORYANDTRADITIONWHETHEROFANCIENTORCOMPARATIVELYRECENTTIMESARESUBJECTEDTOVERYDIFFERENTHANDLINGFROMTHATWHICHTHEINDULGENCEORCREDULITYOFFORMERAGESCOULDALLOWMERESTATEMENTSAREJEALOUSLYWATCHEDANDTHEMOTIVESOFTHEWRITERFORMASIMPORTANTANINGREDIENTINTHEANALYSISOFHISHISTORYASTHEFACTSHERECORDSPROBABILITYISAPOWERFULANDTROUBLESOMETESTANDITISBYTHISTROUBLESOMESTANDARDTHATALARGEPORTIONOFHISTORICALEVIDENCEISSIFTEDCONSISTENCYISNOLESSPERTINACIOUSANDEXACTINGINITSDEMANDSINBRIEFTOWRITEAHISTORYWEMUSTKNOWMORETHANMEREFACTSHUMANNATUREVIEWEDUNDERANINDUCTIONOFEXTENDEDEXPERIENCEISTHEBESTHELPTOTHECRITICISMOFHUMANHISTORYHISTORICALCHARACTERSCANONLYBEESTIMATEDBYTHESTANDARDWHICHHUMANEXPERIENCEWHETHERACTUALORTRADITIONARYHASFURNISHEDTOFORMCORRECTVIEWSOFINDIVIDUALSWEMUSTREGARDTHEMASFORMINGPARTSOFAGREATWHOLEWEMUSTMEASURETHEMBYTHEIRRELATIONTOTHEMASSOFBEINGSBYWHOMTHEYARESURROUNDEDANDINCONTEMPLATINGTHEINCIDENTSINTHEIRLIVESORCONDITIONWHICHTRADITIONHASHANDEDDOWNTOUSWEMUSTRATHERCONSIDERTHEGENERALBEARINGOFTHEWHOLENARRATIVETHANTHERESPECTIVEPROBABILITYOFITSDETAILS
```
The results will be written to output_filename.txt in the same folder. Notice, it will only contain plaintext after decrypting.

Implementation
---
### Step1: Determine the keyword length ###
First, we split cipheretext into different numbers of groups. **Notice, the maximum of group number we try is 10.**
```
def grouping(text):
    ans_list = []
    for n in range(2, 11):
        group = {}
        for i in range(0, n):
            group[i] = []
            #print(group)
        for idx in range(0, len(text)):
            group[idx % n].append(text[idx])
        ans_dic = getIC(group)
        ans_list.append(ans_dic)
    return ans_list
```
Calculate the average I.C. of groups we get from the previous step.
```
def getIC(group):
    dic = {}
    ans_dic = {}
    for main_key in group:
        total = 0
        ans_dic[main_key] = 0

        for i in range(ord('A'), ord('Z') + 1):
            dic[chr(i)] = 0

        for letter in group[main_key]:
            if letter in dic:
                dic[letter] += 1

        for key in dic.keys():
            ni = dic[key]
            total += ni * (ni - 1)

        ans = float(total) / (len(group[main_key]) * (len(group[main_key]) - 1))
        ans_dic[main_key] = ans
    return ans_dic
```
Compare the average I.C. with different numbers of groups to see which value is the maximum. And it will determine the result of key length.
>For example, if we seperate ciphertext into 4 groups and 5 groups, then calculate their average I.C. is 0.04 and 0.06. The most likely length of the keyword will be 5.

### Step2: Determine the key value ###
After determine the key length of the cipheretext, we need to shift letter left by 0~25 for each group and calculate chi-square score.
The key value of each group will result in the minimum chi-squared score.

The formula of chi-squared score is $\sum\frac{(Observed-Expected)^2}{Expected}$.
The observed value is the appear times of one letter in that group, and the expected value can be calculated by the frequency multiply with the length of that group.

>Expected Frequency
>"A": 0.08497, "B": 0.01492, "C": 0.02202, "D": 0.04253, "E": 0.11162, "F": 0.02228, "G": 0.02015
>"H": 0.06094, "I": 0.07546, "J": 0.00153, "K": 0.01292, "L": 0.04025, "M": 0.02406, "N": 0.06749
>"O": 0.07507, "P": 0.01929, "Q": 0.00095, "R": 0.07587, "S": 0.06327, "T": 0.09356, "U": 0.02758
>"V": 0.00978, "W": 0.02560, "X": 0.00150, "Y": 0.01994, "Z": 0.00077 

We can then investigate the possible key word by comparing and finding the smallest chi-squared scores.

>For example, if the chi-squared score associated with key value 6, which corresponds to the letter of G, is 3378.3, while the  chi-squared score associated with key value 7, which corresponds to letter H, is 33.1. It seems that letter H is most likely be the key word for this group because it has smaller chi-squared score.

### Step3: Recover the plaintext ###
To get the result of plaintext, we can shift the letters in each group left by its key value.
>For example, if the ciphertext is Z, and the key word H. To encrypt the cipheretext, we need to shift Z left by 7. So the result will be S.

```
def chiSquare(text, key_length):
    ans_list = []
    group, dic = {}, {}
    expected_freq = {"A": 0.08497, "B": 0.01492, "C": 0.02202, "D": 0.04253, "E": 0.11162,
                     "F": 0.02228, "G": 0.02015, "H": 0.06094, "I": 0.07546, "J": 0.00153,
                     "K": 0.01292, "L": 0.04025, "M": 0.02406, "N": 0.06749, "O": 0.07507,
                     "P": 0.01929, "Q": 0.00095, "R": 0.07587, "S": 0.06327, "T": 0.09356,
                     "U": 0.02758, "V": 0.00978, "W": 0.02560, "X": 0.00150, "Y": 0.01994, "Z": 0.00077}    

    for i in range(0, key_length):
        group[i] = []
    for idx in range(0, len(text)):
        group[idx % (key_length)].append(text[idx])

    # start counting chi-square for each group
    # shift means plus n then mod 26    
    for k in group:
        chi, shift_n = float('inf'), 0
        shift_string = ''
        obs = []
        # shift n
        for n in range(0, 26):
            temp_string = ''
            temp_chi = 0
            for i in range(ord('A'), ord('Z') + 1):
                dic[chr(i)] = 0
            for letter in group[k]:
                if letter in dic:
                    temp_string += chr((((ord(letter) - n - 65) % 26) + 65))
                    dic[chr(((ord(letter) - n - 65) % 26) + 65)] += 1
            for key in dic.keys():
                temp_chi += ((dic[key] - expected_freq[key]*len(group[k]))**2) / (expected_freq[key]*len(group[k]))
            
            # Find the answer of shifting text
            if temp_chi < chi:
                shift_n = n
                chi = temp_chi
                shift_string = temp_string
                #print(shift_n, chi, ans_string)
        ans_list.append([shift_n, shift_string])
    return ans_list
```

### Encrypted Message1 and the Plaintext ###
```
Ciphertext: ZQQTK PQUWD PGMWD BQTXY LFQWL SHAJB UCIPV KUQEJ RBAAC LRSIZ ZCRWT LDFMT PGYXF ISOSE ASZXN PHTAY HHIIR ADDIJ LBFOE VKUWW VFFLV TCEXG HFFXF ZVGXF BFQEI ZOSEZ UGFGF UJUGK PCZWZ UQQJI VAFLV CSDCX YOPYR SQTEI HQFII VTAYI LRGGR AWARN LAGWK JCZXZ UIMPC FTAVX LHMRU LAMRT PDMXV VIDWV SJQWW YCYOE VKXIU NSBVV CWAYJ SMMGH BWDIU DSYYJ AGQXR ZWPIF SRZSK PCZWR URQQS YOOIW YSELF USEEE KOEAV SSMVE DSYYJ APQHR PZKYE SSMVE PBSWF TSFLZ UUILZ JVUXY HGOSJ AIERF ZAMPC SONSL YOZHR ULUIK FHAET XIUVV HBPXY PGPMW MWOYC AMMXK HQTIJ PHEIC MAAVV JZAWV SMFSR UOSIZ UKTMT ODDSX YSEWY HGSEZ USPEJ AFARX HGOIE KSZGP VJQVG YSVYU PQQEE KWZAY PQTTV YGARJ HBPXY PBSWR YSPEP IMPEP MWZHZ UUFLV PFDIR SZQZV SWZPZ LIAJK OSUVT VBHIE AWARR SJMPL LHTIJ HAQTI PBOMG SSEAY PQTLR CSEAV WHMAR FHDEU PHUSE HZMFL ZSEEE KKTMT OODID HYURX YOBMU OOHST HAARX AVQVV CSZYV ZCRWZ USOYI PGFWR UREXI PDBME NHTIK OWZXR DRDCM LWXJI VAMXK YOOXZ CSEYG LFEXZ AWARJ HFQAF YYURX HGMGK PJQPP PBXMK LFMXL YSMWZ UGAGZ LHKXY LQDIU BZUXP VTARV DFUXV YCDXY LDMVK POXMK FCREE VHTII MWZHJ HGBSN LFRYC HHAYT OGFSE LOZHR ZKTSC LGAQV HQTEJ AWEID LBFME AVQLV HZFLP ZQQTK PQUWD VTMXV TDQVR ASOPR ZGAJR UHMKF UWEXJ HGFLV KFQED ZCRGF UGQVM HHUWD VFFLV PABSJ AIDIJ VTBPL YOXMJ AGURV JIDIJ PBFLV JVGVT OVUWK VFKEE KHDEU PHUSE DVQXY LFAJR UQUIE ACDGF TDMVR AWHIC FFQGV UHFMD LGMVV ZINNV JHQHK VJQVP KWRJV YSZXY HBPPZ UURVF THTEK DVUGY AVQME KIXKV UQQSI JFQHL SWFCF MTAVD LFMKV ZQAYC KOXPF DAQVV ZHMXV TSZXJ HFQNV HZAYJ SMIEK JVQHR URFLV TCFMM LGAJK OSIVZ ASDJF YAMWZ TDAVK HBFEE PBSVV KWQRK PBFLV HBMPP ZWESW OWELZ ZHAVP HGFLV MOOXJ OSDIT VFPWG YCNES PZUXP PGMTF DSDJL SOZHK YCGFC LGAQV ASEXR URUXZ ZPKXY PGFVF BPXIJ VAQWK HBPEI KHTEK HZMVX LDAVK PCZSW OWEXF YWOEC LJUHV UQQMJ ZWRXV KQARJ PGFIE JMUWE VZQWJ WSDXZ UOOMF BGMRU LLMGK PBSME PHEHV TOZHJ PBNVZ LTFSN YWFIR OWEXF YMIID BGFOE VKYSI LHTEE TSDIW HQFWY BAMRE HHGVV CWQAV KIZHV YOZME KIOXZ VBAJV EHQRU LRQBG LFUIE JSUWK OSNIJ AVQPG ACFLV JFUXZ JWEQF MVGQR UVUWK VFKLZ ZHAVZ JOXGY HFMGK LFEGR UCZPP ISQWK PAMXV KPKXY LGFEE KODHN OWOLY BAMRV EDQVZ LBOIN OSFLV YOOXL HZAVK YOPMK PCZEI FVMWW BFZMJ OSPXF MCDQT VFDIT AJUIN ZCRME KWHMU BOXWN LAGWK YSSEI KHTID HGRSI TWZKG HFFWF MOSVV HHILF SSIID BGFQV HGGVV AVQQS FHTIZ YFQPR AWARK VHTID HGESW ISURX ZPKAY VAFLV FODIJ BFDSL URQHR URURT VBFID WZMXZ UUFLV PBOMU LBFWZ UHTIZ YZUZV ZCDGF URUXZ VBILZ JVFVR KWFMF UVMWY HBPIU KCIRK VIEAV TIEXI HHTII JCZWZ KSDXY LUQRV YOXFV HFURX VTFLV DVAPV UODVR AWHIK OOZXY LFQWG LQFMM LDDSS HPUPZ AMAJZ AGPIK HWXW
Key Length: 5
Keyword: HOMER
Plaintext: SCEPTICISMISASMUCHTHERESULTOFKNOWLEDGEASKNOWLEDGEISOFSCEPTICISMTOBECONTENTWITHWHATWEATPRESENTKNOWISFORTHEMOSTPARTTOSHUTOUREARSAGAINSTCONVICTIONSINCEFROMTHEVERYGRADUALCHARACTEROFOUREDUCATIONWEMUSTCONTINUALLYFORGETANDEMANCIPATEOURSELVESFROMKNOWLEDGEPREVIOUSLYACQUIREDWEMUSTSETASIDEOLDNOTIONSANDEMBRACEFRESHONESANDASWELEARNWEMUSTBEDAILYUNLEARNINGSOMETHINGWHICHITHASCOSTUSNOSMALLLABOURANDANXIETYTOACQUIREANDTHISDIFFICULTYATTACHESITSELFMORECLOSELYTOANAGEINWHICHPROGRESSHASGAINEDASTRONGASCENDENCYOVERPREJUDICEANDINWHICHPERSONSANDTHINGSAREDAYBYDAYFINDINGTHEIRREALLEVELINLIEUOFTHEIRCONVENTIONALVALUETHESAMEPRINCIPLESWHICHHAVESWEPTAWAYTRADITIONALABUSESANDWHICHAREMAKINGRAPIDHAVOCAMONGTHEREVENUESOFSINECURISTSANDSTRIPPINGTHETHINTAWDRYVEILFROMATTRACTIVESUPERSTITIONSAREWORKINGASACTIVELYINLITERATUREASINSOCIETYTHECREDULITYOFONEWRITERORTHEPARTIALITYOFANOTHERFINDSASPOWERFULATOUCHSTONEANDASWHOLESOMEACHASTISEMENTINTHEHEALTHYSCEPTICISMOFATEMPERATECLASSOFANTAGONISTSASTHEDREAMSOFCONSERVATISMORTHEIMPOSTURESOFPLURALISTSINECURESINTHECHURCHHISTORYANDTRADITIONWHETHEROFANCIENTORCOMPARATIVELYRECENTTIMESARESUBJECTEDTOVERYDIFFERENTHANDLINGFROMTHATWHICHTHEINDULGENCEORCREDULITYOFFORMERAGESCOULDALLOWMERESTATEMENTSAREJEALOUSLYWATCHEDANDTHEMOTIVESOFTHEWRITERFORMASIMPORTANTANINGREDIENTINTHEANALYSISOFHISHISTORYASTHEFACTSHERECORDSPROBABILITYISAPOWERFULANDTROUBLESOMETESTANDITISBYTHISTROUBLESOMESTANDARDTHATALARGEPORTIONOFHISTORICALEVIDENCEISSIFTEDCONSISTENCYISNOLESSPERTINACIOUSANDEXACTINGINITSDEMANDSINBRIEFTOWRITEAHISTORYWEMUSTKNOWMORETHANMEREFACTSHUMANNATUREVIEWEDUNDERANINDUCTIONOFEXTENDEDEXPERIENCEISTHEBESTHELPTOTHECRITICISMOFHUMANHISTORYHISTORICALCHARACTERSCANONLYBEESTIMATEDBYTHESTANDARDWHICHHUMANEXPERIENCEWHETHERACTUALORTRADITIONARYHASFURNISHEDTOFORMCORRECTVIEWSOFINDIVIDUALSWEMUSTREGARDTHEMASFORMINGPARTSOFAGREATWHOLEWEMUSTMEASURETHEMBYTHEIRRELATIONTOTHEMASSOFBEINGSBYWHOMTHEYARESURROUNDEDANDINCONTEMPLATINGTHEINCIDENTSINTHEIRLIVESORCONDITIONWHICHTRADITIONHASHANDEDDOWNTOUSWEMUSTRATHERCONSIDERTHEGENERALBEARINGOFTHEWHOLENARRATIVETHANTHERESPECTIVEPROBABILITYOFITSDETAILS
```


### Encrypted Message2 and the Plaintext ###
```
Ciphertext: IVIKDKDQMJGLPWLZGMPFBJIIDBBYSLJDXFGBIWWEHAPHEYSGNCCYOOTSTZABCOBVRTAZEYWVWWAZAIDGAZPETHPVBPWOBVJXGFMDOBCGPFKXKSZZAIGCJRPETACJHUTHPVHKJHPZHFPMEVZEQSBYOMHSDVFTASFGZTCOBZCGHFMDOBCWVNVBRVKRGXDBMKFBTGBVGMPTBVFMTGBLBMXZWESHGCBYSKDTBYSFWOARQHCJQEQBCUIDCNCHWWGNEDWIHPTKQCZGDKIGDENHPZGIGWVTWIASBFHATQIJSBCDWZBMPGQKKTHTQIGMEFMJSGISLKCFTHPVFXLSZVHAGSMGCLHWJCSXMDTRBTIWWEGHUHPVGXRZCJWHCCZZBVPFKVFTIWWECYIVQJUXCHTVATCWVRBHJHPFILTCNYWLUOBYSKHAIEGBDBBYSKTKIJHATSFGZTCOBZCGIVIKVXLOAZBAXRQEUYDFITFBBSWIHAPHPVKTHAIUOGSHPRHMWSGNWLWSLKCTKCQUOGPGGCIFDFBYOMWSPRRLDAMUWLTOAVKAXQPTONHSLYWLHSOISZPHQFBBRCCCRMWWVBCYCCWKVXGOLVENPHMJCEJHQFBLIVMJSMWSVYOWICJVGBUHMUOGSPICOGRSLRUTXBAKSTRVWKVXG
Key Length: 6
Keyword: POIROT
Plaintext: THATPROCESSSAIDISTARTSUPONTHESUPPOSITIONTHATWHENYOUHAVEELIMINATEDALLWHICHISIMPOSSIBLETHENWHATEVERREMAINSHOWEVERIMPROBABLEMUSTBETHETRUTHITMAYWELLBETHATSEVERALEXPLANATIONSREMAININWHICHCASEONETRIESTESTAFTERTESTUNTILONEOROTHEROFTHEMHASACONVINCINGAMOUNTOFSUPPORTWEWILLNOWAPPLYTHISPRINCIPLETOTHECASEINPOINTASITWASFIRSTPRESENTEDTOMETHEREWERETHREEPOSSIBLEEXPLANATIONSOFTHESECLUSIONORINCARCERATIONOFTHISGENTLEMANINANOUTHOUSEOFHISFATHERSMANSIONTHEREWASTHEEXPLANATIONTHATHEWASINHIDINGFORACRIMEORTHATHEWASMADANDTHATTHEYWISHEDTOAVOIDANASYLUMORTHATHEHADSOMEDISEASEWHICHCAUSEDHISSEGREGATIONICOULDTHINKOFNOOTHERADEQUATESOLUTIONSTHESETHENHADTOBESIFTEDANDBALANCEDAGAINSTEACHOTHER
```
